//@version=6
indicator('OZEL INDIKATOr 1', overlay = true)

//=====================================================================                                                                                      
// Zaman dilimleri
//=====================================================================

// Zaman Dilimlerini SeÃ§me
// timeframes = input.timeframes(defval=["1", "5", "15", "30", "60", "240", "1440"], title="Zaman Dilimleri")

// timeframe = "1", "5", "15", "30", "60", "240", "1440"


// timeframe = input.timeframe('240', title = 'Zaman Dilimi')
// 1 3 5 10 15 30 60 240 1440 10080  


showIndicators = input(true, title = 'Show Indicators')

//=====================================================================     
//=====================================================================
// Mesaj etiketleri
//=====================================================================
tooltip_macd = '### 1. **MACD (Moving Average Convergence Divergence)**- **Al Sinyali (Buy Signal)**:  - MACD yukai kesiÅŸim (MACD Ã§izgisi sinyal Ã§izgisini yukarÄ± kesti)  - Histogram pozitif (Histogram pozitif bÃ¶lgede)- **Sat Sinyali (Sell Signal)**: - MACD aÅŸaÄŸÄ± kesiÅŸim (MACD Ã§izgisi sinyal Ã§izgisini aÅŸaÄŸÄ± kesti) - Histogram negatif (Histogram negatif bÃ¶lgede)'
//=====================================================================
tooltip_adxaciklamali = 'Evet, ADX, +DI ve -DI gÃ¶stergelerini kullanarak trendin y ve gÃ¼cÃ¼ hakkÄ±nda daha iyi bir anlayÄ±ÅŸ elde edebiliriz. Ã–rneklerle aÃ§Ä±klayalÄ±m:### 1. UP Trendi:- **+DI 25, -DI 20, ADX 40**  - **+DI 25:** Pozitif yÃ¶nlÃ¼ hareket, fiyatlarÄ±n UPte olduÄŸunu gÃ¶sterir.  - **-DI 20:** Negatif yÃ¶nlÃ¼ hareket daha zayÄ±f.  - **ADX 40:** GÃ¼Ã§lÃ¼ bir trend var. Bu durumda, UP trendinin gÃ¼Ã§lÃ¼ olduÄŸunu ve devam edeceÄŸini anlarÄ±z.### 2. DW Trendi:- **+DI 10, -DI 30, ADX 40**  - **+DI 10:** Pozitif yÃ¶nlÃ¼ hareket zayÄ±f.  - **-DI 30:** Negatif yÃ¶nlÃ¼ hareket, fiyatlarÄ±n DWte olduÄŸunu gÃ¶sterir.  - **ADX 40:** GÃ¼Ã§lÃ¼ bir trend var. Bu durumda, DW trendinin gÃ¼Ã§lÃ¼ olduÄŸunu ve devam edeceÄŸini anlarÄ±z.### 3. ZayÄ±f UP Trendi:- **+DI 60, -DI 10, ADX 19**  - **+DI 60:** Pozitif yÃ¶nlÃ¼ hareket, fiyatlarÄ±n UPte olduÄŸunu gÃ¶sterir.  - **-DI 10:** Negatif yÃ¶nlÃ¼ hareket Ã§ok zayÄ±f.  - **ADX 19:** Trend zayÄ±f. Bu durumda, UP trendi olsa da, bu trendin gÃ¼Ã§lÃ¼ olmadÄ±ÄŸÄ±nÄ± anlarÄ±z.### 4. ZayÄ±f DW Trendi:- **-DI 40, +DI 5, ADX 19**  - **-DI 40:** Negatif yÃ¶nlÃ¼ hareket, fiyatlarÄ±n DWte olduÄŸunu gÃ¶sterir.  - **+DI 5:** Pozitif yÃ¶nlÃ¼ hareket Ã§ok zayÄ±f.  - **ADX 19:** Trend zayÄ±f. Bu durumda, DW trendi olsa da, bu trendin gÃ¼Ã§lÃ¼ olmadÄ±ÄŸÄ±nÄ± anlarÄ±z.### Ã–zetBu strateji ile, ADX, +DI ve -DI gÃ¶stergelerini kullanarak trendin y ve gÃ¼cÃ¼ hakkÄ±nda aÅŸaÄŸÄ±daki gibi sonuÃ§lar Ã§Ä±karabiliriz:- **ADX > 20:** GÃ¼Ã§lÃ¼ trend (yne +DI ve -DI karar verir).- **ADX < 20:** ZayÄ±f trend (yne +DI ve -DI karar verir).- **+DI > -DI:** UP trendi.- **-DI > +DI:** DW trendi.Bu strateji, teknik analizde TRND ve gÃ¼cÃ¼nÃ¼ belirlemek iÃ§in oldukÃ§a etkilidir. doÄŸru anladÄ±ÄŸÄ±nÄ±zÄ± ve uyguladÄ±ÄŸÄ±nÄ±zÄ± gÃ¶sterir.'
//=====================================================================
//=====================================================================



//=====================================================================
//=====================================================================
//=====================================================================
dynamic_text_size = input.string('small', title = 'Text Size', options = ['tiny', 'small', 'normal', 'large', 'huge'])

var text_size_dynamic = size.small // Default size
if dynamic_text_size == 'tiny'
    text_size_dynamic := size.tiny
    text_size_dynamic
else if dynamic_text_size == 'small'
    text_size_dynamic := size.small
    text_size_dynamic
else if dynamic_text_size == 'normal'
    text_size_dynamic := size.normal
    text_size_dynamic
else if dynamic_text_size == 'large'
    text_size_dynamic := size.large
    text_size_dynamic
else if dynamic_text_size == 'huge'
    text_size_dynamic := size.huge
    text_size_dynamic
    //=====================================================================
    //=====================================================================
    // GÃ¼ncel fiyatÄ± al ve goster hucre icinde 
    // GÃ¼ncel fiyatÄ± al
current_price = close

// var table_id1 = table.new(position.middle_left, 13, 17, border_width=1)



//=====================================================================  
//=====================================================================                                                                                      
// SMA EMA RSI MACD LINE MACD SIGNAL BB RSI  dilimleri
//=====================================================================

// Parametreler
// SMA uzunluklarÄ±nÄ± belirleme
sma_short_length = input.int(30, title = 'SMA Short Length')
sma_medium_length = input.int(50, title = 'SMA Medium Length')
sma_long_length = input.int(200, title = 'SMA Long Length')

ema_length = input.int(20, title = 'EMA Length')

rsi_length = input.int(14, title = 'RSI Length')

// ===================================================
// MACD parametreleri
// ===================================================
macd_fast = input.int(12, title = 'MACD Fast Length')
macd_slow = input.int(26, title = 'MACD Slow Length')
macd_signal = input.int(9, title = 'MACD Signal Length')
// ===================================================

bb_length = input.int(20, title = 'Bollinger Bands Length')
bb_mult = input.float(2.0, title = 'Bollinger Bands Multiplier')
stoch_k_length = input.int(14, title = 'Stochastic %K Length')
stoch_d_length = input.int(3, title = 'Stochastic %D Length')
atr_length = input.int(14, title = 'ATR Length')
sar_acceleration = input.float(0.02, title = 'SAR Acceleration')
sar_maximum = input.float(0.2, title = 'SAR Maximum')
factor = input.float(2.5, title = 'SuperTrend Factor')
atrPeriod = input.int(15, title = 'SuperTrend ATR Period')

// Input for MA lengths
ma1_length = input.int(5, title = 'MA 5 Length')
ma2_length = input.int(8, title = 'MA 8 Length')
ma3_length = input.int(13, title = 'MA 13 Length')

// 1. SuperTrend HesaplamalarÄ± Fonksiyonu
calculate_super_trend(factor, atr_period) =>
    [super_trend, trend_direction] = ta.supertrend(factor, atr_period)
    [super_trend, trend_direction]


// 2. AlÄ±m ve SatÄ±m KoÅŸullarÄ± Fonksiyonu
f_buySellSignals(direction) =>
    buySignal = ta.crossunder(direction, 0)
    sellSignal = ta.crossover(direction, 0)
    [buySignal, sellSignal]

// 3. RSI HesaplamalarÄ±
rsi(source, length) =>
    ta.rsi(source, length)

// 4. MACD HesaplamalarÄ±
macd(source, fastLength, slowLength, signalSmoothing) =>
    ta.macd(source, fastLength, slowLength, signalSmoothing)

// 5. MA HesaplamalarÄ±
ma(source, length) =>
    ta.sma(source, length)


// En yÃ¼ksek ve en dÃ¼ÅŸÃ¼k fiyatlarÄ± belirleme
var float high_price = na
var float low_price = na

if na(high_price) or high > high_price
    high_price := high
    high_price
if na(low_price) or low < low_price
    low_price := low
    low_price

// ===========================
// MA Hesaplamalar
// ===========================
ma1 = ta.sma(close, ma1_length)
ma2 = ta.sma(close, ma2_length)
ma3 = ta.sma(close, ma3_length)
// ===========================

// SuperTrend HesaplamalarÄ±
[superTrend, direction] = calculate_super_trend(factor, atrPeriod)

// // SuperTrend Ã‡izgilerini Ã‡izme
// plot(direction > 0 ? na : superTrend, color=color.red, linewidth=2, title="SuperTrend SatÄ±ÅŸ")
// plot(direction < 0 ? na : superTrend, color=color.green, linewidth=2, title="SuperTrend AlÄ±ÅŸ")

// AlÄ±m ve SatÄ±m KoÅŸullarÄ±
[buySignal, sellSignal] = f_buySellSignals(direction)

// AlÄ±m ve SatÄ±m Sinyallerini Ã‡izme
plotshape(series = buySignal, location = location.belowbar, color = color.green, style = shape.triangleup, text = 'AL', textcolor = color.white, size = size.small, offset = -5)
plotshape(series = sellSignal, location = location.abovebar, color = color.red, style = shape.triangledown, text = 'SAT', textcolor = color.white, size = size.small, offset = -5)

// 10. Teknik GÃ¶sterge HesaplamalarÄ±

// RSI HesaplamalarÄ±
rsiValue = rsi(close, rsi_length)
rsiOverbought = 70
rsiOversold = 30

// MACD Hesaplama Fonksiyonu
f_macd(source, fast_length, slow_length, signal_length) =>
    [macd_line, signal_line, hist_line] = ta.macd(source, fast_length, slow_length, signal_length)
    [macd_line, signal_line, hist_line]

// MACD HesaplamalarÄ±
[macdLine, signalLine, macdHist] = macd(close, macd_fast, macd_slow, macd_signal)

// MA HesaplamalarÄ±
maValue = ma(close, sma_short_length)
plot(maValue, color = color.blue, linewidth = 2, title = 'MA')

// Dashboard HesaplamalarÄ±

// SMA Hesaplama
f_sma(val, length) =>
    ta.sma(val, length)

// SMA Hesaplama
sma_short = ta.sma(close, sma_short_length)
sma_medium = ta.sma(close, sma_medium_length)
sma_long = ta.sma(close, sma_long_length)

// SMA DeÄŸeri
sma_val = f_sma(close, sma_short_length)

// EMA Hesaplama
f_ema(val, length) =>
    ta.ema(val, length)

// EMA DeÄŸeri
ema_val = f_ema(close, ema_length)

// RSI Hesaplama
f_rsi(val, length) =>
    ta.rsi(val, length)

// RSI DeÄŸeri
rsi_val = f_rsi(close, rsi_length)


// ======================================
// MACD Hesaplama
// ======================================

// MACD DeÄŸerleri
[macd_line, signal_line, macd_hist] = f_macd(close, macd_fast, macd_slow, macd_signal)

// MACD Durum Belirleme
var string macd_status = na
if macd_hist > 0
    macd_status := 'UP'
    macd_status
else if macd_hist < 0
    macd_status := 'DW'
    macd_status
else
    macd_status := 'NÃ¶tr'
    macd_status

// ======================================
// ======================================


// Bollinger Bands Hesaplama
f_bb(val, length, mult) =>
    sma = ta.sma(val, length)
    dev = ta.stdev(val, length)
    upper = sma + dev * mult
    lower = sma - dev * mult
    [upper, sma, lower]

// Bollinger Bands DeÄŸerleri
[bb_upper, bb_middle, bb_lower] = f_bb(close, bb_length, bb_mult)

// ====================================================
// ====================================================
// ====================================================

// Stochastic Hesaplama Fonksiyonu
f_stoch(close, high, low, k_length, d_length) =>
    k = ta.stoch(close, high, low, k_length)
    d = ta.sma(k, d_length)
    [k, d]

// Stochastic DeÄŸerleri
[stoch_k_val, stoch_d_val] = f_stoch(close, high, low, stoch_k_length, stoch_d_length)

// AÅŸÄ±rÄ± AlÄ±m/SatÄ±m BÃ¶lgeleri
overbought = 80
oversold = 20

// Trend Belirleme
var string trend = na
if stoch_k_val > stoch_d_val and stoch_k_val < oversold
    trend := 'UP'
    trend
else if stoch_k_val < stoch_d_val and stoch_k_val > overbought
    trend := 'DW'
    trend
else
    trend := 'NÃ¶tr'
    trend

// // Trend Durumunu GÃ¶rselleÅŸtirme
bgcolor(trend == 'UP' ? #ff07071a : trend == 'DW' ? #00ff1e1a : na)

// ====================================================
// 6. ATR HesaplamalarÄ±
// ====================================================
atr(length, timeframe) =>
    request.security(syminfo.tickerid, timeframe, ta.atr(length))

// ATR HesaplamalarÄ±
atrValue = ta.atr(atr_length)

// ATR Hesaplama
f_atr(length) =>
    ta.atr(length)

// ATR DeÄŸeri
atr_val = f_atr(atr_length)

// ATR Durum Belirleme
var string atr_status = na
atr_threshold = ta.sma(atr_val, 100) // ATR'nin 100 periyotluk basit hareketli ortalamasÄ±

if atr_val > atr_threshold
    atr_status := 'YÃ¼ksek'
    atr_status
else if atr_val < atr_threshold
    atr_status := 'DÃ¼ÅŸÃ¼k'
    atr_status
else
    atr_status := 'NÃ¶tr'
    atr_status

// ====================================================
// 7. SAR HesaplamalarÄ± Fonksiyonu
f_sar(acceleration, maximum) =>
    ta.sar(acceleration, acceleration, maximum)

// SAR Hesaplama
sar_val = f_sar(sar_acceleration, sar_maximum)

// GÃ¶sterge sonucu hesaplama
sonuc = (rsiValue < rsiOversold ? 1 : rsiValue > rsiOverbought ? -1 : 0) + (macdHist > 0 ? 1 : macdHist < 0 ? -1 : 0) + (close > sma_val ? 1 : -1) + (close > ema_val ? 1 : -1) + (close > bb_middle ? 1 : -1) + (stoch_k_val > 80 ? -1 : stoch_k_val < 20 ? 1 : 0)

// GÃ¶stergeler iÃ§in parametreler

// GÃ¶sterge skoru hesaplama
rsi_score = (rsiValue < rsiOversold ? 1 : rsiValue > rsiOverbought ? -1 : 0) * 0.2
macd_score = (macdHist > 0 ? 1 : macdHist < 0 ? -1 : 0) * 0.3
sma_ema_score = (close > sma_val ? 1 : -1) * 0.1
bollinger_score = (close > bb_middle ? 1 : -1) * 0.1
stochastic_score = (stoch_k_val > 80 ? -1 : stoch_k_val < 20 ? 1 : 0) * 0.2
atr_score = (atr_val > ta.sma(atr_val, 14) ? -1 : 1) * 0.1
sar_score = (sar_val > close ? 1 : -1) * 0.2

// ===================================
// hacim hesaplamasi 
// ====================================================================
// Hacim formasyonu hacim kodu
// ====================================================================

// Tablonun OluÅŸturulmasÄ±
// Mevcut zaman dilimindeki hacim verisini kullanma
volume_data = volume
previous_volume = volume[1]

// Hacim yÃ¼zdesi deÄŸiÅŸimi hesaplama
volume_change_percent = (volume_data - previous_volume) / previous_volume * 100

// Hacim verisini renklendirme
volume_color = volume_data > previous_volume ? color.green : color.red

// Tooltip mesajlarÄ±
tooltip_volume = 'Hacim Verisi:\n\nYeÅŸil: Hacim artÄ±ÅŸÄ±\nKÄ±rmÄ±zÄ±: Hacim azalÄ±ÅŸÄ±'
// ====================================================================
// ====================================================================



// Kompozit skor hesaplama
kompozit_skor = rsi_score + macd_score + sma_ema_score + bollinger_score + stochastic_score + atr_score + sar_score

// SkorlarÄ±n normalizasyonu (isteÄŸe baÄŸlÄ±)
normalized_score = (kompozit_skor + 1) / 2 // Skoru 0 ile 1 arasÄ±nda normalize etme

// plot(kompozit_skor, title="Kompozit Skor", color=color.blue, linewidth=2)

// 11. Tablonun OluÅŸturulmasÄ±
var table_id = table.new(position.bottom_left, 20, 17, border_width = 1)

// RSI ynÃ¼ belirleme
rsi_prev = ta.rsi(close[1], rsi_length)
rsi_direction = rsi_val > rsi_prev ? 'UP' : rsi_val < rsi_prev ? 'DW' : 'NÃ¶tr'

// 12. HÃ¼crelerin Ã‡izilmesi
// ðŸ“Œ Kompozit Skor AÃ§Ä±klamasÄ± (Tooltip)
tooltip_kompozit = "ðŸ“Š Kompozit Skor: FarklÄ± gÃ¶stergelerin birleÅŸimiyle hesaplanÄ±r.\n\n" +
                   "âœ… Pozitif (YeÅŸil): Genel olarak UP sinyali.\n" +
                   "âš ï¸ Negatif (KÄ±rmÄ±zÄ±): Genel olarak DW sinyali.\n" +
                   "ðŸ”¸ NÃ¶tr (SarÄ±): Belirsiz piyasa koÅŸullarÄ±."

// ðŸ“Œ Skor Renk ve Ä°kon AyarlamasÄ±
kompozit_color = kompozit_skor > 0 ? color.green : kompozit_skor < 0 ? color.red : color.yellow
kompozit_icon = kompozit_skor > 0 ? "ðŸ“ˆ" : kompozit_skor < 0 ? "ðŸ“‰" : "âš–ï¸"

// ðŸ“Œ Tablo GÃ¼ncellemesi
table.cell(table_id, 0, 0, text = 'ðŸ“Š Kompozit Skor', text_color = color.black, bgcolor = color.white, tooltip = tooltip_kompozit)
table.cell(table_id, 0, 1, text = kompozit_icon + " " + str.tostring(kompozit_skor, format.mintick), text_color = color.black, bgcolor = kompozit_color)

// hacim Tablo hÃ¼crelerini doldurma
// ðŸ“Œ Hacim AÃ§Ä±klamasÄ± (Tooltip)
tooltip_volume1 = "ðŸ“Š Hacim Verisi:\n\n" +
                 "âœ… YeÅŸil: **Hacim artÄ±ÅŸÄ± (AlÄ±cÄ± baskÄ±n)** ðŸ“ˆ\n" +
                 "âŒ KÄ±rmÄ±zÄ±: **Hacim DWÃ¼ (SatÄ±cÄ± baskÄ±n)** ðŸ“‰\n" +
                 "âš ï¸ SarÄ±: **Hacim sabit, dÃ¼ÅŸÃ¼k volatilite** âš–ï¸"

// ðŸ“Œ Hacim Renk ve Ä°kon AyarlamasÄ±
volume_color1 = volume_data > previous_volume ? color.green : volume_data < previous_volume ? color.red : color.yellow
volume_icon = volume_data > previous_volume ? "ðŸ“ˆ ArtÄ±ÅŸ" : volume_data < previous_volume ? "ðŸ“‰ DW" : "âš–ï¸ Sabit"

// ðŸ“Œ Tablo GÃ¼ncellemesi
table.cell(table_id, 2, 0, text = 'ðŸ“Š Hacim', text_color = color.black, bgcolor = color.white, tooltip = tooltip_volume1)
table.cell(table_id, 2, 1, text = volume_icon + " " + str.tostring(volume_data, format.volume), text_color = color.black, bgcolor = volume_color)
table.cell(table_id, 2, 2, text = volume_icon + " " + str.tostring(volume_change_percent, format.percent) + '%', text_color = color.black, bgcolor = volume_color)
// 
// 
// ====================================================================
// Sma Ema hucre icinde tablos gosterimi
// ====================================================================
is_golden_cross = ta.crossover(sma_short, sma_medium)
is_death_cross = ta.crossunder(sma_short, sma_medium)

// Kesim fiyatÄ±nÄ± belirleme
var float cross_price = na
var string cross_text = ''
var color cross_color = na

if is_golden_cross
    cross_price := close
    cross_text := 'Golden Cross'
    cross_color := color.yellow
    cross_color
else if is_death_cross
    cross_price := close
    cross_text := 'Death Cross'
    cross_color := color.red
    cross_color

// ==================================================
// ====================================================================
// ====================================================================
var table_id4 = table.new(position.bottom_right, 23, 17, border_width = 1)
// ====================================================================


// ======================================
// ATR Hucre giostergesi
// ======================================
if bar_index == 0
    table.cell(table_id4, 13, 0, text = 'ATR', text_color = color.black, bgcolor = color.white)
    table.cell(table_id4, 14, 0, text = 'ATRâ†“/â†‘', text_color = color.black, bgcolor = color.white)

table.cell(table_id4, 13, 1, text = str.tostring(atr_val, format.mintick), text_color = color.black, bgcolor = color.white)
table.cell(table_id4, 14, 1, text = atr_status, text_color = color.black, bgcolor = atr_status == 'YÃ¼ksek' ? color.red : atr_status == 'DÃ¼ÅŸÃ¼k' ? color.green : color.yellow)
//=====================================================================                                                                                      

table.cell(table_id4, 15, 0, text = 'Price', text_color = color.white, bgcolor = color.blue)
// GÃ¼ncel fiyatÄ± tabloya ekleme (her Ã§ubukta gÃ¼ncellenir)
table.cell(table_id4, 15, 1, text = str.tostring(current_price, format.mintick), text_color = color.black, bgcolor = color.white)

//=====================================================================                                                                                      
// MACD DeÄŸerlerini Tablo HÃ¼crelerinde GÃ¶sterme
//=====================================================================                                                                                      
// ðŸ“Œ MACD Tablo BaÅŸlÄ±ÄŸÄ± (Sadece Ä°lk Ã‡ubukta Ã‡alÄ±ÅŸtÄ±r)
if bar_index == 0
    table.cell(table_id4, 1, 0, text="MCD", text_color=color.blue, bgcolor=color.white, tooltip=tooltip_macd)
    table.cell(table_id4, 2, 0, text="MSGL", text_color=color.red, bgcolor=color.white)
    table.cell(table_id4, 3, 0, text="MHIS", text_color=color.green, bgcolor=color.white)


// ðŸ“Œ MACD DeÄŸerlerini Tabloya YazdÄ±r
table.cell(table_id4, 1, 1, text=str.tostring(macd_line, format.mintick), text_color=color.blue, bgcolor=color.white)
table.cell(table_id4, 2, 1, text=str.tostring(signal_line, format.mintick), text_color=color.red, bgcolor=color.white)

// Histogram Rengi (Pozitif â†’ YeÅŸil, Negatif â†’ KÄ±rmÄ±zÄ±, NÃ¶tr â†’ SarÄ±)
hist_color = macd_hist > 0 ? color.green : macd_hist < 0 ? color.red : color.yellow
table.cell(table_id4, 3, 1, text=str.tostring(macd_hist, format.mintick), text_color=color.black, bgcolor=hist_color)

// ======================================
// Stockastik rsi
// ======================================
// Tabloda GÃ¶rÃ¼ntÃ¼leme
// ðŸ“Œ Stochastic Tablo BaÅŸlÄ±ÄŸÄ± (Sadece Ä°lk Ã‡ubukta Ã‡alÄ±ÅŸtÄ±r)
if bar_index == 0
    table.cell(table_id4, 5, 0, text="ST %K", text_color=color.orange, bgcolor=color.white)
    table.cell(table_id4, 6, 0, text="ST %D", text_color=color.red, bgcolor=color.white)

// ðŸ“Œ Stochastic %K ve %D DeÄŸerlerini Tabloya YazdÄ±r
stoch_k_color = stoch_k_val > 80 ? color.red : stoch_k_val < 20 ? color.green : color.yellow
stoch_d_color = stoch_d_val > 80 ? color.red : stoch_d_val < 20 ? color.green : color.yellow

table.cell(table_id4, 5, 1, text=str.tostring(stoch_k_val, format.mintick), text_color=color.black, bgcolor=stoch_k_color)
table.cell(table_id4, 6, 1, text=str.tostring(stoch_d_val, format.mintick), text_color=color.black, bgcolor=stoch_d_color)

// ====================================================================
//  Rsi
// RSI Hesaplama ve GÃ¶sterimi
// ====================================================================
// ðŸ“Œ RSI Tablo BaÅŸlÄ±ÄŸÄ± (Sadece Ä°lk Ã‡ubukta Ã‡alÄ±ÅŸtÄ±r)
if bar_index == 0
    table.cell(table_id4, 8, 0, text="RSI", text_color=color.purple, bgcolor=color.white)

// ðŸ“Œ RSI DeÄŸerini Belirleme ve Tabloya YazdÄ±rma
rsi_color = rsi_val > rsiOverbought ? color.red : rsi_val < rsiOversold ? color.green : color.yellow

table.cell(table_id4, 8, 1, text=str.tostring(rsi_val, format.mintick), text_color=color.purple, bgcolor=rsi_color)

// ====================================================================
// ðŸ“Œ EMA & SMA DeÄŸerlerini Tabloya YazdÄ±rma
// ====================================================================

if bar_index == 0
    table.cell(table_id4, 10, 0, text="SMA", text_color=color.blue, bgcolor=color.white)
    table.cell(table_id4, 11, 0, text="EMA", text_color=color.red, bgcolor=color.white)
    table.cell(table_id4, 12, 0, text="E ðŸ”€ S ", text_color=color.rgb(27, 182, 68), bgcolor=color.white)

// ðŸ“Œ SMA & EMA Renk Belirleme
sma_color = sma_val > close ? color.red : sma_val < close ? color.green : color.yellow
ema_color = ema_val > close ? color.red : ema_val < close ? color.green : color.yellow

// ðŸ“Œ DeÄŸerleri Tabloya YazdÄ±rma
table.cell(table_id4, 10, 1, text=str.tostring(sma_val, format.mintick), text_color=color.black, bgcolor=sma_color)
table.cell(table_id4, 11, 1, text=str.tostring(ema_val, format.mintick), text_color=color.black, bgcolor=ema_color)
table.cell(table_id4, 12, 1, text=not na(cross_price) ? str.tostring(cross_price, format.mintick) : "N/A", text_color=color.black, bgcolor=color.white)
// table.cell(table_id4, 4, 0, text=cross_text, text_color=color.black, bgcolor=color.white)
//=====================================================================                                                                                      
// Bolliger bands ve fibonacci birlikte kullanilmasi
//=====================================================================

//=====================================================================                                                                                      
length = 20
src = close
mult = 2.0

basis = ta.sma(src, length)
dev = mult * ta.stdev(src, length)



// ðŸ“Œ Blink efekti isteÄŸe baÄŸlÄ±
enable_blink = input.bool(true, title = 'YanÄ±p SÃ¶nme Efekti')
var int blink = na
if enable_blink
    blink := second(timenow) % 2 == 0 ? 1 : 0
    blink

// ðŸ“Œ Yeni tablo oluÅŸturma
var table2_id = table.new(position.top_center, 40, 40, border_width = 1)

// ðŸ“Œ AÃ§Ä±klama metni
tooltip_fibo = 'Fibonacci Geri Ã‡ekilme Seviyeleri:\n\n' + '- %38.2, %50, %61.8 seviyelerinde destek/direnÃ§ olabilir.\n' + '- Bu seviyelerde kÄ±rÄ±lmalar veya dÅŸler trend deÄŸiÅŸikliklerini iÅŸaret edebilir.'

// ðŸ“Œ Renk belirleme fonksiyonu
f_getBBColor(level, c) =>
    level > c ? bool(blink) ? color.red : color.white : level < c ? bool(blink) ? color.green : color.white : bool(blink) ? color.yellow : color.white

// ðŸ“Œ Bollinger Bands seviyelerini tabloya ekleme
table.cell(table2_id, 0, 1, text = 'BBU', text_color = color.blue, bgcolor = color.white, tooltip = tooltip_fibo)
table.cell(table2_id, 1, 1, text = str.tostring(bb_upper, format.mintick), text_color = color.black, bgcolor = f_getBBColor(bb_upper, close))

table.cell(table2_id, 0, 2, text = 'BBO', text_color = color.blue, bgcolor = color.white)
table.cell(table2_id, 1, 2, text = str.tostring(bb_middle, format.mintick), text_color = color.black, bgcolor = f_getBBColor(bb_middle, close))

table.cell(table2_id, 0, 3, text = 'BBA', text_color = color.blue, bgcolor = color.white)
table.cell(table2_id, 1, 3, text = str.tostring(bb_lower, format.mintick), text_color = color.black, bgcolor = f_getBBColor(bb_lower, close))
//=====================================================================                                                                                      


//=====================================================================                                                                                      
// SESLI AL SAT UYARILARI SUPER TREND ICIN 
//=====================================================================

// Alert conditions
alertcondition(buySignal, title = 'SuperTrend Buy Alert', message = 'SuperTrend Buy Signal')
alertcondition(sellSignal, title = 'SuperTrend Sell Alert', message = 'SuperTrend Sell Signal')

// Trigger alerts
if buySignal and barstate.isrealtime
    alert('SuperTrend Buy Signal RSI: ' + str.tostring(rsiValue, '#.##') + ' MCD: ' + str.tostring(macdHist, '#.#####'), alert.freq_once_per_bar_close)

if sellSignal and barstate.isrealtime
    alert('SuperTrend Sell Signal RSI: ' + str.tostring(rsiValue, '#.##') + ' MCD: ' + str.tostring(macdHist, '#.#####'), alert.freq_once_per_bar_close)
    //=====================================================================                                                                                      

// ======================================
// Fibonacci seviyeleri hesaplama fonksiyonu
// ======================================

fibonacci_levels(high_price, low_price) =>
    diff = high_price - low_price
    level_0 = high_price
    level_1 = high_price - 0.236 * diff
    level_2 = high_price - 0.382 * diff
    level_3 = high_price - 0.5 * diff
    level_4 = high_price - 0.618 * diff
    level_5 = low_price
    [level_0, level_1, level_2, level_3, level_4, level_5]

// En yÃ¼ksek ve en dÃ¼ÅŸÃ¼k fiyatlarÄ± belirleme
highest_high = ta.highest(high, 100)
lowest_low = ta.lowest(low, 100)

// `ta.highest` ve `ta.lowest` fonksiyonlarÄ±nÄ± dÄ±ÅŸarÄ±da Ã§aÄŸÄ±rma
highest_high_val = ta.highest(highest_high, 100)
lowest_low_val = ta.lowest(lowest_low, 100)

hh = ta.highest(high, 100)
ll = ta.lowest(low, 100)

highest_high_val := na(highest_high_val) ? hh : highest_high_val
lowest_low_val := na(lowest_low_val) ? ll : lowest_low_val

// Fibonacci seviyelerini hesaplama
[level_0, level_1, level_2, level_3, level_4, level_5] = fibonacci_levels(highest_high_val, lowest_low_val)

// TRNDnÃ¼ Belirleme
trend_direction = na(close[1]) ? na : close > close[1] ? 'UP' : 'DW'


// ðŸ“Œ Fibonacci seviyelerini tabloya ekleme
if bar_index == 0
    table.cell(table2_id, 2, 1, text="ðŸ”¹ F 0%", text_color=color.blue, bgcolor=color.white)
    table.cell(table2_id, 2, 2, text="ðŸ”¸ F 23.6%", text_color=color.blue, bgcolor=color.white)
    table.cell(table2_id, 2, 3, text="ðŸ”¹ F 38.2%", text_color=color.blue, bgcolor=color.white)
    table.cell(table2_id, 4, 1, text="ðŸ”¸ F 50%", text_color=color.blue, bgcolor=color.white)
    table.cell(table2_id, 4, 2, text="ðŸ”¹ F 61.8%", text_color=color.blue, bgcolor=color.white)
    table.cell(table2_id, 4, 3, text="ðŸ”¸ F 100%", text_color=color.blue, bgcolor=color.white)

// ðŸ“Œ Fibonacci seviyelerini tabloya ekleme (DeÄŸerler)
table.cell(table2_id, 3, 1, text=str.tostring(level_0, format.mintick), text_color=color.black, text_halign=text.align_right,    bgcolor=trend_direction == "ðŸ“ˆ UP" ? (blink == 1 ? color.green : color.white) : (blink == 1 ? color.red : color.white))

table.cell(table2_id, 3, 2, text=str.tostring(level_1, format.mintick), text_color=color.black, text_halign=text.align_right,    bgcolor=trend_direction == "ðŸ“ˆ UP" ? (blink == 1 ? color.green : color.white) : (blink == 1 ? color.red : color.white))

table.cell(table2_id, 3, 3, text=str.tostring(level_2, format.mintick), text_color=color.black, text_halign=text.align_right,    bgcolor=trend_direction == "ðŸ“ˆ UP" ? (blink == 1 ? color.green : color.white) : (blink == 1 ? color.red : color.white))

table.cell(table2_id, 5, 1, text=str.tostring(level_3, format.mintick), text_color=color.black, text_halign=text.align_right,    bgcolor=trend_direction == "ðŸ“ˆ UP" ? (blink == 1 ? color.green : color.white) : (blink == 1 ? color.red : color.white))

table.cell(table2_id, 5, 2, text=str.tostring(level_4, format.mintick), text_color=color.black, text_halign=text.align_right,    bgcolor=trend_direction == "ðŸ“ˆ UP" ? (blink == 1 ? color.green : color.white) : (blink == 1 ? color.red : color.white))

table.cell(table2_id, 5, 3, text=str.tostring(level_5, format.mintick), text_color=color.black, text_halign=text.align_right,    bgcolor=trend_direction == "ðŸ“ˆ UP" ? (blink == 1 ? color.green : color.white) : (blink == 1 ? color.red : color.white))

// //  tablo cizimi metin olarak gÃ¶sterme
var ttable_id = table.new(position.middle_right, 100, 100, border_width = 1)

// Create table
var table_id5 = table.new(position.middle_left, 100, 100, border_width = 1)



// Determine trend direction
ma1_trend = ma1 > ma1[1] ? 'Up' : ma1 < ma1[1] ? 'Down' : 'Flat'
ma2_trend = ma2 > ma2[1] ? 'Up' : ma2 < ma2[1] ? 'Down' : 'Flat'
ma3_trend = ma3 > ma3[1] ? 'Up' : ma3 < ma3[1] ? 'Down' : 'Flat'

// Fill table with MA values and trends
// ðŸ“Œ MA BaÅŸlÄ±klarÄ±

    // ðŸ“Œ MA AÃ§Ä±klamalarÄ± (Tooltip)
tooltip_ma5 = "ðŸ“ MA 5: 5 periyotluk hareketli ortalama\nKÄ±sa vadeli trendi gÃ¶sterir."
tooltip_ma8 = "ðŸ“ MA 8: 8 periyotluk hareketli ortalama\nDaha dengeli kÄ±sa vadeli TRNDÃ¶stergesi."
tooltip_ma13 = "ðŸ“ MA 13: 13 periyotluk hareketli ortalama\nOrta vadeli trend takibi iÃ§in kullanÄ±lÄ±r."

// ðŸ“Œ MA BaÅŸlÄ±klarÄ± + Tooltip EklenmiÅŸ
if bar_index == 0
    table.cell(table2_id, 7, 0, text = "ðŸ“ MA 5", text_color = color.white, bgcolor = color.blue, text_halign = text.align_center, tooltip = tooltip_ma5)
    table.cell(table2_id, 8, 0, text = "ðŸ“ MA 8", text_color = color.white, bgcolor = color.blue, text_halign = text.align_center, tooltip = tooltip_ma8)
    table.cell(table2_id, 9, 0, text = "ðŸ“ MA 13", text_color = color.white, bgcolor = color.blue, text_halign = text.align_center, tooltip = tooltip_ma13)

// ðŸ“Œ MA DeÄŸerlerini Tabloya Ekleme
table.cell(table2_id, 7, 1, text = str.tostring(ma1, format.mintick), text_color = color.black, bgcolor = color.white, text_halign = text.align_center)
table.cell(table2_id, 7, 2, text = ma1_trend == "Up" ? "ðŸ“ˆ UP" : ma1_trend == "Down" ? "ðŸ“‰ DW" : "â–¬ NÃ¶tr",     text_color = color.black, bgcolor = ma1_trend == "Up" ? color.green : ma1_trend == "Down" ? color.red : color.gray, text_halign = text.align_center)
table.cell(table2_id, 7, 3, text = str.tostring(timeframe.period), text_color = color.black, bgcolor = color.white, text_halign = text.align_center)

table.cell(table2_id, 8, 1, text = str.tostring(ma2, format.mintick), text_color = color.black, bgcolor = color.white, text_halign = text.align_center)
table.cell(table2_id, 8, 2, text = ma2_trend == "Up" ? "ðŸ“ˆ UP" : ma2_trend == "Down" ? "ðŸ“‰ DW" : "â–¬ NÃ¶tr",     text_color = color.black, bgcolor = ma2_trend == "Up" ? color.green : ma2_trend == "Down" ? color.red : color.gray, text_halign = text.align_center)
table.cell(table2_id, 8, 3, text = str.tostring(timeframe.period), text_color = color.black, bgcolor = color.white, text_halign = text.align_center)

table.cell(table2_id, 9, 1, text = str.tostring(ma3, format.mintick), text_color = color.black, bgcolor = color.white, text_halign = text.align_center)
table.cell(table2_id, 9, 2, text = ma3_trend == "Up" ? "ðŸ“ˆ UP" : ma3_trend == "Down" ? "ðŸ“‰ DW" : "â–¬ NÃ¶tr",     text_color = color.black, bgcolor = ma3_trend == "Up" ? color.green : ma3_trend == "Down" ? color.red : color.gray, text_halign = text.align_center)
table.cell(table2_id, 9, 3, text = str.tostring(timeframe.period), text_color = color.black, bgcolor = color.white, text_halign = text.align_center)



// sar indikatoru kodu
// Tooltip mesajlarÄ±

// Tabloya SAR deÄŸerlerini ekleme
// ðŸ“Œ SAR AÃ§Ä±klamasÄ± (Tooltip)
tooltip_sar = "ðŸ“ SAR (Parabolic Stop and Reverse):\n\n" +
              "âœ… SAR fiyatÄ±n altÄ±ndaysa: **UP sinyali (AlÄ±m)** ðŸ“ˆ\n" +
              "âŒ SAR fiyatÄ±n Ã¼zerindeyse: **DW sinyali (SatÄ±ÅŸ)** ðŸ“‰\n" +
              "âš ï¸ SAR fiyat seviyesine yakÄ±nsa: **Belirsiz sinyal (NÃ¶tr)** âš–ï¸"

// ðŸ“Œ SAR Renk ve Ä°kon AyarlamasÄ±
sar_color = sar_val > close ? color.red : sar_val < close ? color.green : color.yellow
sar_icon = sar_val > close ? "ðŸ“‰ Sat" : sar_val < close ? "ðŸ“ˆ Al" : "âš–ï¸ NÃ¶tr"

// ðŸ“Œ Tablo GÃ¼ncellemesi
table.cell(table2_id, 10, 1, text = 'ðŸ“ SAR', text_color = color.green, bgcolor = color.white, tooltip = tooltip_sar)
table.cell(table2_id, 10, 2, text = sar_icon + " " + str.tostring(sar_val, format.mintick), text_color = color.black, bgcolor = sar_color)

// ðŸ“Œ SAR AÃ§Ä±klamasÄ± (Tooltip)
tooltip_sar_trendi = "ðŸ“‰ **Parabolic SAR (Stop and Reverse)**:\n\n" +
              "ðŸ”´ **SAR fiyatÄ±n ÃœSTÃœNDE â†’ DW trendi** ðŸ“‰\n" +
              "ðŸŸ¢ **SAR fiyatÄ±n ALTINDA â†’ UP trendi** ðŸ“ˆ\n" +
              "âšª **SAR fiyatla eÅŸleÅŸmiÅŸ â†’ NÃ¶tr** âš–ï¸"


//=====================================================================                                                                                      
// roc   degelreri
//=====================================================================
// Parametreler
roc_length = input.int(14, title = 'ROC Length')

// ROC Hesaplama Fonksiyonu
f_roc(c, length) =>
    roc = (c - c[length]) / c[length] * 100
    roc

tooltip_roc = 'ROC (DeÄŸiÅŸim OranÄ±):\n\nROC\'nin YÃ¼kselmesi: Pozitif momentum, potansiyel alÄ±m sinyali.\nROC\'nin DÃ¼ÅŸmesi: Negatif momentum, potansiyel satÄ±ÅŸ sinyali.\nROC\'nin Sabit KalmasÄ±: NÃ¶tr durum.'

// ROC DeÄŸeri
roc_value = f_roc(close, roc_length)

// ROC DeÄŸerini Renklendirme
roc_color = roc_value > 0 ? color.green : roc_value < 0 ? color.red : color.yellow

// ðŸ“Œ ROC Renk Belirleme
// roc_color = color.blue
if roc_value > 20
    roc_color := color.red
    roc_color
else if roc_value < -20
    roc_color := color.green
    roc_color
else if roc_value > 0
    roc_color := color.blue
    roc_color
else
    roc_color := color.orange
    roc_color

// ðŸ“Œ Tabloda ROC DeÄŸerlerini GÃ¶sterme
table.cell(table2_id, 11, 1, text = 'ROC', text_color = color.white, bgcolor = color.blue, tooltip = tooltip_roc)
table.cell(table2_id, 11, 2, text = str.tostring(roc_value, format.percent), text_color = color.black, bgcolor = roc_color)

// ðŸ“Œ UyarÄ± ÅžartlarÄ±
alertcondition(roc_value > 20, title = 'ROC Overbought', message = 'ROC is above 20, potential sell signal')
alertcondition(roc_value < -20, title = 'ROC Oversold', message = 'ROC is below -20, potential buy signal')
alertcondition(roc_value > 0 and roc_value <= 20, title = 'ROC Positive Momentum', message = 'ROC is between 0 and 20, positive momentum')
alertcondition(roc_value < 0 and roc_value >= -20, title = 'ROC Negative Momentum', message = 'ROC is between 0 and -20, negative momentum')
alertcondition(roc_value > roc_value[1], title = 'ROC UP', message = 'ROC artÄ±yor, UP trendi olabilir.')
alertcondition(roc_value < roc_value[1], title = 'ROC DW', message = 'ROC dÃ¼ÅŸÃ¼yor, DW trendi olabilir.')
//=====================================================================  
//====================================================================                                                                                      
// Icimoku degelreri
//=====================================================================
// Parametreler
tenkan_length = input.int(9, title = 'Tenkan-sen Length')
kijun_length = input.int(26, title = 'Kijun-sen Length')
senkou_span_b_length = input.int(52, title = 'Senkou Span B Length')

// Ichimoku Bulutu HesaplamalarÄ±
tenkan_sen = (ta.highest(high, tenkan_length) + ta.lowest(low, tenkan_length)) / 2
kijun_sen = (ta.highest(high, kijun_length) + ta.lowest(low, kijun_length)) / 2
senkou_span_a = (tenkan_sen + kijun_sen) / 2
senkou_span_b = (ta.highest(high, senkou_span_b_length) + ta.lowest(low, senkou_span_b_length)) / 2
chikou_span = close

// Renklendirme
tenkan_kijun_color = tenkan_sen > kijun_sen ? color.green : color.red
senkou_span_a_color = senkou_span_a > senkou_span_b ? color.green : color.red

// Kumo Bulutu Renklendirme
plot(senkou_span_a, color = senkou_span_a_color, title = 'Senkou Span A')
plot(senkou_span_b, color = senkou_span_b > senkou_span_a ? color.red : color.green, title = 'Senkou Span B')

// Tooltip mesajlarÄ±
tooltip_tenkan = 'Tenkan-sen (DÅŸ Ã‡izgisi):\n\nFiyatÄ±n kÄ±sa vadeli ortalamasÄ±nÄ± gÃ¶sterir.'
tooltip_kijun = 'Kijun-sen (Baz Ã‡izgisi):\n\nFiyatÄ±n orta vadeli ortalamasÄ±nÄ± gÃ¶sterir.'
tooltip_senkou_span_a = 'Senkou Span A:\n\nTenkan-sen ve Kijun-sen\'in ortalamasÄ±dÄ±r ve geleceÄŸe 26 dÃ¶nem projeksiyon yapar.'
tooltip_senkou_span_b = 'Senkou Span B:\n\nFiyatÄ±n uzun vadeli ortalamasÄ±dÄ±r ve geleceÄŸe 26 dÃ¶nem projeksiyon yapar.'
tooltip_chikou = 'Chikou Span (Gecikme Ã‡izgisi):\n\nKapanÄ±ÅŸ fiyatÄ±nÄ±n 26 dÃ¶nem geriye kaydÄ±rÄ±lmasÄ±dÄ±r.'

// ðŸ“Œ Ichimoku Tablosu GÃ¼ncellenmiÅŸ Versiyon
table.cell(ttable_id, 0, 7, text = 'TENK-sen', text_color = color.red, bgcolor = color.white, tooltip = 'KÄ±sa vadeli TRNDÃ¶stergesi')
table.cell(ttable_id, 1, 7, text = str.tostring(tenkan_sen, format.mintick), text_color = color.white, bgcolor = tenkan_sen > kijun_sen ? color.green : color.red)

table.cell(ttable_id, 0, 8, text = 'KIJN-sen', text_color = color.blue, bgcolor = color.white, tooltip = 'Orta vadeli TRNDÃ¶stergesi')
table.cell(ttable_id, 1, 8, text = str.tostring(kijun_sen, format.mintick), text_color = color.white, bgcolor = tenkan_sen > kijun_sen ? color.green : color.red)

table.cell(ttable_id, 0, 9, text = 'SENK Sp A', text_color = color.green, bgcolor = color.white, tooltip = 'Ã–ncÃ¼ A Ã§izgisi')
table.cell(ttable_id, 1, 9, text = str.tostring(senkou_span_a, format.mintick), text_color = color.white, bgcolor = senkou_span_a > senkou_span_b ? color.green : color.red)

table.cell(ttable_id, 0, 10, text = 'SENK Sp B', text_color = color.orange, bgcolor = color.white, tooltip = 'Ã–ncÃ¼ B Ã§izgisi')
table.cell(ttable_id, 1, 10, text = str.tostring(senkou_span_b, format.mintick), text_color = color.white, bgcolor = senkou_span_a > senkou_span_b ? color.green : color.red)

table.cell(ttable_id, 0, 11, text = 'CHIK SP', text_color = color.black, bgcolor = color.white, tooltip = 'Gecikmeli fiyat gÃ¶stergesi')
table.cell(ttable_id, 1, 11, text = str.tostring(chikou_span, format.mintick), text_color = color.purple, bgcolor = chikou_span > close ? color.green : color.red)

//=====================================================================                                                                                      


// //=====================================================================                                                                                      
// // adx degelreri
// //=====================================================================
// ADX parametreleri
adx_length = input.int(14, title = 'ADX Length')
adx_smoothing = input.int(14, title = 'ADX Smoothing')

// ADX Hesaplama Fonksiyonu
f_adx(length, smoothing) =>
    [diPlus, diMinus, adx] = ta.dmi(length, smoothing)
    [diPlus, diMinus, adx]

// ADX DeÄŸerleri
[diPlus_value, diMinus_value, adx_value] = ta.dmi(adx_length, adx_smoothing)

// ADX Durum Belirleme
var string adx_status = na
var string trend_strength = na

tooltip_adx = 'TRNDÃ¼cÃ¼: ADX 20â€™nin altÄ±ndaysa trend zayÄ±f, 20â€™nin Ã¼zerindeyse TRNDÃ¼Ã§lÃ¼dÃ¼r.\n ADXâ€™in y, trendin gÃ¼Ã§lenip gÃ¼Ã§lenmediÄŸini gÃ¶sterir.'
// tooltip
tooltip_di = '+DI / -DI (YÃ¶nlÃ¼ Hareket GÃ¶stergeleri):\n\n+DI\'nin YÃ¼kselmesi: Pozitif yÃ¶nlÃ¼ hareketin gÃ¼Ã§lendiÄŸini gÃ¶sterir, potansiyel alÄ±m sinyali.\n-DI\'nin YÃ¼kselmesi: Negatif yÃ¶nlÃ¼ hareketin gÃ¼Ã§lendiÄŸini gÃ¶sterir, potansiyel satÄ±ÅŸ sinyali.\n+DI ve -DI\'nin KesiÅŸmesi: Trend deÄŸiÅŸim sinyali.'


// ðŸ“Œ ADX DeÄŸerlerini Tablo HÃ¼crelerinde GÃ¶sterme
if bar_index == 0
    table.cell(ttable_id, 0, 18, text = 'ADX', text_color = color.white, bgcolor = color.blue, tooltip = tooltip_adx)
    table.cell(ttable_id, 0, 21, text = '+DI', text_color = color.white, bgcolor = color.blue, tooltip = tooltip_di)
    table.cell(ttable_id, 0, 22, text = '-DI', text_color = color.white, bgcolor = color.blue, tooltip = tooltip_di)

// ðŸ“Œ ADX DeÄŸerlerini Dinamik Renklerle GÃ¶sterme
adx_bgcolor = adx_value < 20 ? color.red : color.green
trend_arrow = adx_status == 'YukarÄ± Trend' ? 'â–²' : adx_status == 'AÅŸaÄŸÄ± Trend' ? 'â–¼' : 'â–¬'

table.cell(ttable_id, 1, 18, text = str.tostring(adx_value, format.mintick), text_color = color.black, bgcolor = adx_bgcolor)
table.cell(ttable_id, 1, 21, text = 'â–² ' + str.tostring(diPlus_value, format.mintick), text_color = color.white, bgcolor = color.green)
table.cell(ttable_id, 1, 22, text = 'â–¼ ' + str.tostring(diMinus_value, format.mintick), text_color = color.white, bgcolor = color.red)

// ðŸ”” UyarÄ±lar
alertcondition(adx_value > 20, title = 'ADX YÃ¼kseliyor', message = 'ADX yÃ¼kseliyor, TRNDÃ¼Ã§leniyor.')
alertcondition(diPlus_value > diMinus_value, title = '+DI > -DI', message = 'Pozitif yÃ¶nlÃ¼ hareket gÃ¼Ã§leniyor.')
alertcondition(diPlus_value < diMinus_value, title = '+DI < -DI', message = 'Negatif yÃ¶nlÃ¼ hareket gÃ¼Ã§leniyor.')
//=====================================================================                                                                                      

//=====================================================================                                                                                      
// cci  degelreri
//=====================================================================
// Parametreler
cci_length = input.int(20, title = 'CCI Length')

// CCI Hesaplama Fonksiyonu
f_cci(length) =>
    typicalPrice = (high + low + close) / 3
    ma = ta.sma(typicalPrice, length)
    meanDeviation = ta.sma(math.abs(typicalPrice - ma), length)
    cci = (typicalPrice - ma) / (0.015 * meanDeviation)
    cci

tooltip_cci = 'CCI (Emtia Kanal Endeksi):\n\nCCI\'nin 100\'Ã¼n Ãœzerinde OlmasÄ±: AÅŸÄ±rÄ± alÄ±m bÃ¶lgesi, potansiyel satÄ±ÅŸ sinyali.\nCCI\'nin -100\'Ã¼n AltÄ±nda OlmasÄ±: AÅŸÄ±rÄ± satÄ±m bÃ¶lgesi, potansiyel alÄ±m sinyali.\nCCI\'nin -100 ile 100 ArasÄ±nda OlmasÄ±: NÃ¶tr durum.'

// CCI DeÄŸeri
cci_value = f_cci(cci_length)

// CCI DeÄŸerine gÃ¶re renk belirleme
cci_color = cci_value > 100 ? color.green : cci_value < -100 ? color.red : color.yellow

// CCI DeÄŸerini GÃ¶sterme
table.cell(ttable_id, 0, 13, text = 'CCI', text_color = color.black, bgcolor = color.white, tooltip = tooltip_cci)
table.cell(ttable_id, 1, 13, text = str.tostring(cci_value, format.mintick), text_color = color.black, bgcolor = cci_color)

//=====================================================================                                                                                      


//=====================================================================                                                                                      
// MFI   degelreri
//=====================================================================
// Parametreler
mfi_length = input.int(14, title = 'MFI Length')

// MFI Hesaplama Fonksiyonu
f_mfi(h, l, c, v, length) =>
    typical_price = (h + l + c) / 3
    money_flow = typical_price * v
    positive_flow = ta.cum(ta.rma(ta.valuewhen(c > c[1], money_flow, 1), length))
    negative_flow = ta.cum(ta.rma(ta.valuewhen(c < c[1], money_flow, 1), length))
    money_ratio = positive_flow / negative_flow
    mfi = 100 - 100 / (1 + money_ratio)
    mfi

// MFI DeÄŸeri
mfi_value = f_mfi(high, low, close, volume, mfi_length)

tooltip_mfi = 'MFI (Para AkÄ±ÅŸÄ± Endeksi):\n\nMFI\'nin 80\'in Ãœzerinde OlmasÄ±: AÅŸÄ±rÄ± alÄ±m bÃ¶lgesi, potansiyel satÄ±ÅŸ sinyali.\nMFI\'nin 20\'nin AltÄ±nda OlmasÄ±: AÅŸÄ±rÄ± satÄ±m bÃ¶lgesi, potansiyel alÄ±m sinyali.\nMFI\'nin 20-80 ArasÄ±nda OlmasÄ±: NÃ¶tr durum.'


// ðŸ“Œ MFI Renk Belirleme
mfi_color = color.blue
if mfi_value > 80
    mfi_color := color.red
    mfi_color
else if mfi_value < 20
    mfi_color := color.green
    mfi_color
else if mfi_value <= 40
    mfi_color := color.orange
    mfi_color
else if mfi_value <= 60
    mfi_color := color.yellow
    mfi_color

// ðŸ“Œ Tabloda MFI DeÄŸerlerini GÃ¶sterme
table.cell(ttable_id, 0, 23, text = 'MFI', text_color = color.white, bgcolor = color.blue, tooltip = tooltip_mfi)
table.cell(ttable_id, 1, 23, text = str.tostring(mfi_value, format.mintick), text_color = color.black, bgcolor = mfi_color)


// ðŸ“Œ UyarÄ± ÅžartlarÄ±
alertcondition(mfi_value > 80, title = 'MFI Overbought', message = 'MFI is above 80, potential sell signal')
alertcondition(mfi_value < 20, title = 'MFI Oversold', message = 'MFI is below 20, potential buy signal')
alertcondition(mfi_value > 20 and mfi_value <= 40, title = 'MFI Normal Sell', message = 'MFI is between 20 and 40, normal sell condition')
alertcondition(mfi_value > 60 and mfi_value <= 80, title = 'MFI Normal Buy', message = 'MFI is between 60 and 80, normal buy condition')
alertcondition(mfi_value > 40 and mfi_value <= 60, title = 'MFI Neutral', message = 'MFI is between 40 and 60, neutral condition')
alertcondition(mfi_value > mfi_value[1], title = 'MFI UP', message = 'MFI artÄ±yor, UP trendi olabilir.')
alertcondition(mfi_value < mfi_value[1], title = 'MFI DW', message = 'MFI dÃ¼ÅŸÃ¼yor, DW trendi olabilir.')
//=====================================================================                                                                                      

//=====================================================================                                                                                      
// obv   degelreri
//=====================================================================
// OBV Hesaplama Fonksiyonu
// ðŸ“Œ OBV Fonksiyonu
f_obv(c, v) =>
    ta.cum(c > c[1] ? v : c < c[1] ? -v : 0)

// ðŸ“Œ OBV DeÄŸeri
obv_value = f_obv(close, volume)

// ðŸ“Œ OBV AÃ§Ä±klamasÄ±
tooltip_obv = 'OBV (On-Balance Volume):\n\nOBV\'nin YÃ¼kselmesi: Fiyat artÄ±ÅŸÄ± ile desteklenen hacim, potansiyel alÄ±m sinyali.\nOBV\'nin DÃ¼ÅŸmesi: Fiyat DWÃ¼ ile desteklenen hacim, potansiyel satÄ±ÅŸ sinyali.\nOBV\'nin Sabit KalmasÄ±: NÃ¶tr durum.'

// ðŸ“Œ OBV Renk Belirleme
obv_color = color.gray
if obv_value > obv_value[1]
    obv_color := color.green
    obv_color
else if obv_value < obv_value[1]
    obv_color := color.red
    obv_color

// ðŸ“Œ OBV YnÃ¼ Belirleme
obv_trend = 'â–¬ NÃ¶tr'
obv_trend_color = color.gray
if obv_value > obv_value[1]
    obv_trend := 'â–² UP'
    obv_trend_color := color.green
    obv_trend_color
else if obv_value < obv_value[1]
    obv_trend := 'â–¼ DW'
    obv_trend_color := color.red
    obv_trend_color

// ðŸ“Œ OBV DeÄŸerlerini Tabloya Ekleme
table.cell(ttable_id, 0, 27, text = 'OBV', text_color = color.white, bgcolor = color.blue, tooltip = tooltip_obv)
table.cell(ttable_id, 1, 27, text = str.tostring(obv_value, format.volume), text_color = color.black, bgcolor = obv_color)

// ðŸ“Œ UyarÄ± ÅžartlarÄ±
alertcondition(obv_value > obv_value[1], title = 'OBV Accumulation', message = 'OBV is increasing, indicating accumulation')
alertcondition(obv_value < obv_value[1], title = 'OBV Distribution', message = 'OBV is decreasing, indicating distribution')
alertcondition(obv_value == obv_value[1], title = 'OBV Neutral', message = 'OBV is neutral, no significant change')
//===================================================================== 

//=====================================================================
// VWAP Hesaplama Fonksiyonu
//=====================================================================

// ðŸ“Œ VWAP Hesaplama Fonksiyonu
f_vwap(h, l, c, v) =>
    typical_price = (h + l + c) / 3
    ta.cum(typical_price * v) / ta.cum(v)

// ðŸ“Œ VWAP DeÄŸeri
vwap_value = f_vwap(high, low, close, volume)

// ðŸ“Œ VWAP AÃ§Ä±klamasÄ±
tooltip_vwap = 'VWAP (Hacim AÄŸÄ±rlÄ±klÄ± Ortalama Fiyat):\n\nVWAP\'nin Ãœzerinde: Potansiyel alÄ±m sinyali.\nVWAP\'nin AltÄ±nda: Potansiyel satÄ±ÅŸ sinyali.\nVWAP\'de: NÃ¶tr durum.'

// ðŸ“Œ VWAP Renk Belirleme
vwap_color = color.gray
if close > vwap_value
    vwap_color := color.red
    vwap_color
else if close < vwap_value
    vwap_color := color.green
    vwap_color

// ðŸ“Œ VWAP DeÄŸerlerini Tabloya Ekleme
table.cell(ttable_id, 0, 29, text = 'VWAP', text_color = color.white, bgcolor = color.blue, tooltip = tooltip_vwap)
table.cell(ttable_id, 1, 29, text = str.tostring(vwap_value, format.mintick), text_color = color.black, bgcolor = vwap_color)

// ðŸ“Œ UyarÄ± ÅžartlarÄ±
alertcondition(close > vwap_value, title = 'VWAP\'nin AltÄ±nda', message = 'Fiyat VWAP\'nin Ã¼zerinde, potansiyel alÄ±m sinyali')
alertcondition(close < vwap_value, title = 'VWAP\'nin Ãœzerinde', message = 'Fiyat VWAP\'nin altÄ±nda, potansiyel satÄ±ÅŸ sinyali')
alertcondition(close == vwap_value, title = 'VWAP\'de', message = 'Fiyat VWAP\'de, nÃ¶tr durum')
alertcondition(vwap_value > vwap_value[1], title = 'VWAP UP', message = 'VWAP artÄ±yor, UP trendi olabilir.')
alertcondition(vwap_value < vwap_value[1], title = 'VWAP DW', message = 'VWAP dÃ¼ÅŸÃ¼yor, DW trendi olabilir.')
//=====================================================================

// //=====================================================================                                                                                      
// // williamsa r   degelreri
// //=====================================================================
// Williams %R Length
williams_length = input.int(14, title = 'Williams %R Length')

// ðŸ“Œ Williams %R Hesaplama Fonksiyonu
f_williams_r(h, l, c, length) =>
    hh_local = ta.highest(h, length)
    ll_local = ta.lowest(l, length)
    (hh_local - c) / (hh_local - ll_local) * -100

// ðŸ“Œ Williams %R DeÄŸeri (request.security kaldÄ±rÄ±ldÄ±)
williams_r_value = f_williams_r(high, low, close, williams_length)

// ðŸ“Œ Williams %R AÃ§Ä±klamasÄ±
tooltip_williams_r = 'Williams %R:\n\n-20\'nin Ãœzerinde: AÅŸÄ±rÄ± alÄ±m bÃ¶lgesi, potansiyel satÄ±ÅŸ sinyali.\n-80\'nin AltÄ±nda: AÅŸÄ±rÄ± satÄ±m bÃ¶lgesi, potansiyel alÄ±m sinyali.\nArada: NÃ¶tr durum.'

// ðŸ“Œ Williams %R Renk Belirleme
williams_r_color = williams_r_value > -20 ? color.red : williams_r_value < -80 ? color.green : color.gray

// ðŸ“Œ Williams %R DeÄŸerlerini Tek Bir HÃ¼crede GÃ¶stermeÂ§Â§
// SatÄ±r baÅŸlÄ±ÄŸÄ±
table.cell(ttable_id, 0, 31, text = 'W%R', text_color = color.white, bgcolor = color.blue, tooltip = tooltip_williams_r)

// SatÄ±r 1: W%R DeÄŸeri
table.cell(ttable_id, 1, 31, text = str.tostring(williams_r_value, format.percent), text_color = color.black, bgcolor = williams_r_color)

// ðŸ“Œ UyarÄ± ÅžartlarÄ± (AzaltÄ±lmÄ±ÅŸ ve Optimize EdilmiÅŸ)
alertcondition(williams_r_value > -20, title = 'Williams %R AÅŸÄ±rÄ± AlÄ±m', message = 'Williams %R -20\'nin Ã¼zerinde, potansiyel satÄ±ÅŸ sinyali')
alertcondition(williams_r_value < -80, title = 'Williams %R AÅŸÄ±rÄ± SatÄ±m', message = 'Williams %R -80\'nin altÄ±nda, potansiyel alÄ±m sinyali')
alertcondition(williams_r_value > williams_r_value[1] or williams_r_value < williams_r_value[1], title = 'Williams %R Trend DeÄŸiÅŸimi', message = 'Williams %R deÄŸiÅŸim gÃ¶steriyor.')

//=====================================================================
//=====================================================================
// Mesaj etiketleri
//=====================================================================

// ** ---> Inputs ------------- {
var bool positive = false
var bool negative = false
string RSI_group = 'RMI Settings'
string mom_group = 'Range Vales'
string visual = 'Visuals'
int Length = input(14, 'RMI Length ', inline = 'RMI', group = RSI_group)
int pmom = input(66, ' Positive above', inline = 'rsi1', group = RSI_group)
int nmom = input(30, 'Negative below', inline = 'rsi1', group = RSI_group)
bool filleshow = input(true, 'Show Range MA ', inline = '002', group = visual)
color bull = input(#00bcd4, '', inline = '002', group = visual)
color bear = input(#ff5252, '', inline = '002', group = visual)
float BarRange = high - low

up = ta.rma(math.max(ta.change(close), 0), Length)
down = ta.rma(-math.min(ta.change(close), 0), Length)
rsi = down == 0 ? 100 : up == 0 ? 0 : 100 - 100 / (1 + up / down)
mf = ta.mfi(hlc3, Length)
rsi_mfi = math.avg(rsi, mf)



//------------------- }

ema_val_5 = ta.ema(close, 5)
ema_change_5 = ta.change(ema_val_5)

p_mom = rsi_mfi[1] < pmom and rsi_mfi > pmom and rsi_mfi > nmom and ema_change_5 > 0
n_mom = rsi_mfi < nmom and ema_change_5 < 0
// //  ---> Momentums ------------- {

if p_mom
    positive := true
    negative := false
    negative

if n_mom
    positive := false
    negative := true
    negative



//
method _Band(int len) =>
    math.min(ta.atr(len) * 0.3, close * (0.3 / 100))[20] / 2 * 8


Band = _Band(30)


method rangeMA(float Range, Prd) =>
    weight = Range / math.sum(Range, Prd)
    sum = math.sum(close * weight, Prd)
    tw = math.sum(weight, Prd)
    sum / tw


// Calculate the RWMA
rwma = rangeMA(BarRange, 20)

// Plotting the RWMA.
colour = positive ? bull : bear
RWMA = positive ? rwma - Band : negative ? rwma + Band : na
alpha = color.new(color.black, 100)

center = plot(filleshow ? RWMA : na, 'RRTH', colour, editable = true)
plot(filleshow ? RWMA : na, 'RRTH', color.new(colour, 70), 2, editable = true)
plot(filleshow ? RWMA : na, 'RRTH', color.new(colour, 80), 3, editable = true)
plot(filleshow ? RWMA : na, 'RRTH', color.new(colour, 90), 4, editable = true)

max = RWMA + Band
min = RWMA - Band

top = plot(filleshow ? max : na, 'RRTH', alpha)
bottom = plot(filleshow ? min : na, 'RRTH', alpha)
fill(top, center, top_value = max, bottom_value = RWMA, bottom_color = color.new(colour, 75), top_color = alpha, editable = true)
fill(center, bottom, top_value = RWMA, bottom_value = min, bottom_color = alpha, top_color = color.new(colour, 75), editable = true)
Barcol = positive ? color.green : color.red

if negative and not negative[1]
    label.new(bar_index, max + Band / 2, '', color = color.red, size = size.small)
if positive and not positive[1]
    label.new(bar_index, min - Band / 2, '', color = color.green, size = size.small, style = label.style_label_up)


// SPOT Trading Alerts
alertcondition(positive and not positive[1], 'BUY')
alertcondition(negative and not negative[1], 'SELL')

